<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Agentic Memory Simulator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: linear-gradient(135deg, #0a192f 0%, #112240 100%);
            color: #e0e0e0;
            min-height: 100vh;
            padding: 20px;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(255,255,255,0.05);
            border-radius: 15px;
            border: 1px solid rgba(255,255,255,0.1);
        }
        h1 {
            color: #64ffda;
            margin-bottom: 10px;
            font-size: 2.2em;
        }
        .subtitle {
            color: #8892b0;
            font-size: 1.1em;
        }
        .concept-box {
            background: rgba(100, 255, 218, 0.1);
            border: 1px solid rgba(100, 255, 218, 0.3);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
        }
        .concept-box h3 {
            color: #64ffda;
            margin-bottom: 10px;
        }
        .main-content {
            display: grid;
            grid-template-columns: 320px 1fr;
            gap: 20px;
        }
        .controls {
            background: rgba(255,255,255,0.05);
            border-radius: 15px;
            padding: 20px;
            border: 1px solid rgba(255,255,255,0.1);
        }
        .control-group {
            margin-bottom: 20px;
        }
        .control-group label {
            display: block;
            margin-bottom: 8px;
            color: #64ffda;
            font-weight: 500;
        }
        input, select, textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 8px;
            background: rgba(0,0,0,0.3);
            color: #fff;
            font-size: 14px;
        }
        button {
            width: 100%;
            padding: 12px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s;
            margin-bottom: 10px;
        }
        .btn-primary {
            background: linear-gradient(135deg, #64ffda, #00bfa5);
            color: #0a192f;
        }
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(100, 255, 218, 0.4);
        }
        .btn-secondary {
            background: rgba(255,255,255,0.1);
            color: #fff;
            border: 1px solid rgba(255,255,255,0.2);
        }
        .visualization {
            background: rgba(255,255,255,0.05);
            border-radius: 15px;
            padding: 20px;
            border: 1px solid rgba(255,255,255,0.1);
        }
        .memory-types {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }
        .memory-type-card {
            background: rgba(0,0,0,0.3);
            border-radius: 12px;
            padding: 15px;
            cursor: pointer;
            border: 2px solid transparent;
            transition: all 0.3s;
        }
        .memory-type-card:hover {
            border-color: rgba(100, 255, 218, 0.5);
        }
        .memory-type-card.active {
            border-color: #64ffda;
            background: rgba(100, 255, 218, 0.1);
        }
        .type-icon {
            font-size: 28px;
            margin-bottom: 8px;
        }
        .type-name {
            font-weight: 600;
            color: #64ffda;
            margin-bottom: 5px;
        }
        .type-desc {
            font-size: 12px;
            color: #8892b0;
        }
        .memory-view {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        .memory-panel {
            background: rgba(0,0,0,0.3);
            border-radius: 12px;
            padding: 15px;
            min-height: 300px;
        }
        .panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        .panel-title {
            font-weight: 600;
            color: #64ffda;
        }
        .panel-stats {
            font-size: 12px;
            color: #8892b0;
        }
        .memory-item {
            background: rgba(255,255,255,0.05);
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 10px;
            border-left: 3px solid #64ffda;
            animation: slideIn 0.3s ease-out;
        }
        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-10px); }
            to { opacity: 1; transform: translateX(0); }
        }
        .memory-item.fading {
            opacity: 0.4;
            border-color: #666;
        }
        .memory-item.highlighted {
            border-color: #ffd700;
            background: rgba(255, 215, 0, 0.1);
        }
        .item-key {
            font-weight: 600;
            color: #ccd6f6;
            margin-bottom: 4px;
        }
        .item-value {
            font-size: 13px;
            color: #8892b0;
        }
        .item-meta {
            display: flex;
            justify-content: space-between;
            margin-top: 8px;
            font-size: 11px;
            color: #666;
        }
        .graph-view {
            height: 300px;
            position: relative;
            overflow: hidden;
        }
        .graph-node {
            position: absolute;
            background: linear-gradient(135deg, #64ffda, #00bfa5);
            color: #0a192f;
            padding: 8px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }
        .graph-node:hover {
            transform: scale(1.1);
            box-shadow: 0 0 20px rgba(100, 255, 218, 0.5);
        }
        .graph-node.entity {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: #fff;
        }
        .graph-node.event {
            background: linear-gradient(135deg, #f093fb, #f5576c);
            color: #fff;
        }
        .graph-edge {
            position: absolute;
            background: rgba(100, 255, 218, 0.3);
            height: 2px;
            transform-origin: left center;
        }
        .query-panel {
            margin-top: 20px;
            background: rgba(0,0,0,0.3);
            border-radius: 12px;
            padding: 15px;
        }
        .query-input {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }
        .query-input input {
            flex: 1;
        }
        .query-input button {
            width: auto;
            padding: 10px 20px;
            margin: 0;
        }
        .query-result {
            background: rgba(255,255,255,0.05);
            border-radius: 8px;
            padding: 15px;
            min-height: 60px;
        }
        .retrieval-score {
            display: inline-block;
            background: #64ffda;
            color: #0a192f;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 11px;
            font-weight: 600;
            margin-left: 8px;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Agentic Memory Simulator</h1>
            <p class="subtitle">Dynamic Memory Systems: Flat, Structured, and Graph-Based</p>
        </header>

        <div class="concept-box">
            <h3>Concept from "Agentic Reasoning" Survey (Pages 24-25)</h3>
            <p>Agentic memory has evolved from passive storage to active reasoning substrate:</p>
            <ul>
                <li><strong>Flat Memory:</strong> Simple key-value or semantic text storage (MemGPT, LangMem)</li>
                <li><strong>Structured/Graph Memory:</strong> Entities, relationships, and facts in knowledge graphs (GraphRAG, Zep)</li>
                <li><strong>Experience Memory:</strong> Workflows, trajectories, and procedural knowledge</li>
                <li><strong>Memory Management:</strong> Summarization, forgetting, filtering, and verification</li>
            </ul>
            <p style="margin-top:10px;"><em>"Memory is increasingly treated as an integral component of the reasoning loop, not just storage."</em></p>
        </div>

        <div class="main-content">
            <div class="controls">
                <div class="control-group">
                    <label>Memory Type</label>
                    <select id="memoryType" onchange="switchMemoryType()">
                        <option value="flat">Flat / Semantic Memory</option>
                        <option value="graph">Graph Memory</option>
                        <option value="experience">Experience Memory</option>
                    </select>
                </div>

                <div class="control-group">
                    <label>Add Memory Entry</label>
                    <input type="text" id="memKey" placeholder="Key / Entity">
                    <input type="text" id="memValue" placeholder="Value / Relation" style="margin-top:8px;">
                </div>

                <button class="btn-primary" onclick="addMemory()">Store in Memory</button>
                <button class="btn-secondary" onclick="simulateDecay()">Simulate Time Decay</button>
                <button class="btn-secondary" onclick="clearMemory()">Clear Memory</button>

                <div class="control-group" style="margin-top:20px;">
                    <label>Memory Operations</label>
                    <button class="btn-secondary" onclick="consolidateMemory()">Consolidate (Summarize)</button>
                    <button class="btn-secondary" onclick="forgetOldest()">Forget Oldest</button>
                </div>

                <div style="margin-top:20px; padding:15px; background:rgba(0,0,0,0.2); border-radius:10px;">
                    <div style="color:#64ffda; font-weight:600; margin-bottom:10px;">Memory Stats</div>
                    <div style="font-size:13px; color:#8892b0;">
                        <div>Total Items: <span id="totalItems">0</span></div>
                        <div>Active Items: <span id="activeItems">0</span></div>
                        <div>Memory Usage: <span id="memUsage">0%</span></div>
                    </div>
                </div>
            </div>

            <div class="visualization">
                <div class="memory-types">
                    <div class="memory-type-card active" onclick="selectType('flat')">
                        <div class="type-icon">üìù</div>
                        <div class="type-name">Flat Memory</div>
                        <div class="type-desc">Key-value pairs with semantic similarity retrieval</div>
                    </div>
                    <div class="memory-type-card" onclick="selectType('graph')">
                        <div class="type-icon">üï∏Ô∏è</div>
                        <div class="type-name">Graph Memory</div>
                        <div class="type-desc">Entities and relationships in connected structure</div>
                    </div>
                    <div class="memory-type-card" onclick="selectType('experience')">
                        <div class="type-icon">üìö</div>
                        <div class="type-name">Experience Memory</div>
                        <div class="type-desc">Workflows and procedural trajectories</div>
                    </div>
                </div>

                <div class="memory-view">
                    <div class="memory-panel" id="shortTermPanel">
                        <div class="panel-header">
                            <span class="panel-title">Short-Term / Working Memory</span>
                            <span class="panel-stats" id="stmStats">0 items</span>
                        </div>
                        <div id="shortTermContent"></div>
                    </div>
                    <div class="memory-panel" id="longTermPanel">
                        <div class="panel-header">
                            <span class="panel-title">Long-Term Memory</span>
                            <span class="panel-stats" id="ltmStats">0 items</span>
                        </div>
                        <div id="longTermContent"></div>
                    </div>
                </div>

                <div class="query-panel">
                    <div style="font-weight:600; color:#64ffda; margin-bottom:10px;">Memory Retrieval Query</div>
                    <div class="query-input">
                        <input type="text" id="queryInput" placeholder="What do you want to recall?" onkeypress="if(event.key==='Enter')queryMemory()">
                        <button class="btn-primary" onclick="queryMemory()">Retrieve</button>
                    </div>
                    <div class="query-result" id="queryResult">
                        <span style="color:#666;">Enter a query to retrieve relevant memories...</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        class MemorySystem {
            constructor() {
                this.shortTerm = [];
                this.longTerm = [];
                this.maxShortTerm = 5;
                this.maxLongTerm = 20;
                this.timestep = 0;
                this.type = 'flat';
            }

            add(key, value, metadata = {}) {
                const entry = {
                    id: Date.now() + Math.random(),
                    key,
                    value,
                    timestamp: this.timestep,
                    accessCount: 0,
                    importance: metadata.importance || 0.5,
                    decayed: false,
                    ...metadata
                };

                this.shortTerm.unshift(entry);

                // Promote to long-term if short-term overflows
                while (this.shortTerm.length > this.maxShortTerm) {
                    const promoted = this.shortTerm.pop();
                    promoted.promotedAt = this.timestep;
                    this.longTerm.unshift(promoted);
                }

                // Evict from long-term if full
                while (this.longTerm.length > this.maxLongTerm) {
                    this.longTerm.pop();
                }

                this.render();
            }

            query(queryText) {
                const results = [];
                const queryLower = queryText.toLowerCase();
                const queryWords = queryLower.split(/\s+/);

                const allItems = [...this.shortTerm, ...this.longTerm];

                for (const item of allItems) {
                    const textToMatch = `${item.key} ${item.value}`.toLowerCase();
                    let score = 0;

                    for (const word of queryWords) {
                        if (textToMatch.includes(word)) {
                            score += 0.3;
                        }
                    }

                    // Boost for exact key match
                    if (item.key.toLowerCase().includes(queryLower)) {
                        score += 0.5;
                    }

                    // Recency boost
                    const recency = 1 / (1 + (this.timestep - item.timestamp) * 0.1);
                    score += recency * 0.2;

                    // Access count boost
                    score += Math.min(item.accessCount * 0.05, 0.2);

                    if (score > 0.1) {
                        item.accessCount++;
                        results.push({ item, score: Math.min(score, 1) });
                    }
                }

                results.sort((a, b) => b.score - a.score);
                return results.slice(0, 5);
            }

            decay() {
                this.timestep++;

                for (const item of this.longTerm) {
                    const age = this.timestep - item.timestamp;
                    if (age > 5 && item.accessCount < 2) {
                        item.decayed = true;
                    }
                }

                this.render();
            }

            consolidate() {
                // Simulate memory consolidation - merge similar entries
                if (this.longTerm.length < 2) return;

                const consolidated = {
                    key: 'Consolidated Memory',
                    value: `Summary of ${Math.min(3, this.longTerm.length)} memories: ${this.longTerm.slice(0, 3).map(m => m.key).join(', ')}`,
                    isConsolidated: true
                };

                // Remove oldest items and add consolidated
                this.longTerm = this.longTerm.slice(0, -2);
                this.add(consolidated.key, consolidated.value, { importance: 0.8, isConsolidated: true });
            }

            forgetOldest() {
                if (this.longTerm.length > 0) {
                    this.longTerm.pop();
                    this.render();
                }
            }

            clear() {
                this.shortTerm = [];
                this.longTerm = [];
                this.timestep = 0;
                this.render();
            }

            render() {
                this.renderPanel('shortTermContent', this.shortTerm);
                this.renderPanel('longTermContent', this.longTerm);

                document.getElementById('stmStats').textContent = `${this.shortTerm.length} items`;
                document.getElementById('ltmStats').textContent = `${this.longTerm.length} items`;
                document.getElementById('totalItems').textContent = this.shortTerm.length + this.longTerm.length;
                document.getElementById('activeItems').textContent =
                    this.shortTerm.length + this.longTerm.filter(m => !m.decayed).length;
                document.getElementById('memUsage').textContent =
                    Math.round(((this.shortTerm.length + this.longTerm.length) / (this.maxShortTerm + this.maxLongTerm)) * 100) + '%';
            }

            renderPanel(panelId, items) {
                const panel = document.getElementById(panelId);

                if (items.length === 0) {
                    panel.innerHTML = '<div style="color:#666; text-align:center; padding:20px;">No memories stored</div>';
                    return;
                }

                panel.innerHTML = items.map(item => `
                    <div class="memory-item ${item.decayed ? 'fading' : ''} ${item.isConsolidated ? 'highlighted' : ''}">
                        <div class="item-key">${this.escapeHtml(item.key)}</div>
                        <div class="item-value">${this.escapeHtml(item.value)}</div>
                        <div class="item-meta">
                            <span>t=${item.timestamp} | acc=${item.accessCount}</span>
                            <span>imp: ${(item.importance * 100).toFixed(0)}%</span>
                        </div>
                    </div>
                `).join('');
            }

            escapeHtml(text) {
                const div = document.createElement('div');
                div.textContent = text;
                return div.innerHTML;
            }
        }

        const memory = new MemorySystem();

        // Pre-populate with sample data
        function initSampleData() {
            memory.add('User Preference', 'Prefers dark mode and concise responses', { importance: 0.8 });
            memory.add('Project Context', 'Working on agentic AI simulator project', { importance: 0.9 });
            memory.add('Last Query', 'Asked about memory architectures', { importance: 0.5 });
            memory.add('Technical Note', 'Graph memory uses entity-relationship structure', { importance: 0.7 });
        }

        function addMemory() {
            const key = document.getElementById('memKey').value.trim();
            const value = document.getElementById('memValue').value.trim();

            if (key && value) {
                memory.add(key, value, { importance: Math.random() * 0.5 + 0.5 });
                document.getElementById('memKey').value = '';
                document.getElementById('memValue').value = '';
            }
        }

        function queryMemory() {
            const query = document.getElementById('queryInput').value.trim();
            if (!query) return;

            const results = memory.query(query);
            const resultEl = document.getElementById('queryResult');

            if (results.length === 0) {
                resultEl.innerHTML = '<span style="color:#666;">No relevant memories found</span>';
                return;
            }

            resultEl.innerHTML = results.map(r => `
                <div style="margin-bottom:10px; padding:10px; background:rgba(100,255,218,0.1); border-radius:6px;">
                    <strong>${memory.escapeHtml(r.item.key)}</strong>
                    <span class="retrieval-score">${(r.score * 100).toFixed(0)}% match</span>
                    <div style="font-size:13px; color:#8892b0; margin-top:4px;">${memory.escapeHtml(r.item.value)}</div>
                </div>
            `).join('');

            memory.render();
        }

        function simulateDecay() {
            memory.decay();
        }

        function consolidateMemory() {
            memory.consolidate();
        }

        function forgetOldest() {
            memory.forgetOldest();
        }

        function clearMemory() {
            memory.clear();
        }

        function selectType(type) {
            document.querySelectorAll('.memory-type-card').forEach(el => el.classList.remove('active'));
            event.currentTarget.classList.add('active');
            document.getElementById('memoryType').value = type;
            memory.type = type;
        }

        function switchMemoryType() {
            const type = document.getElementById('memoryType').value;
            document.querySelectorAll('.memory-type-card').forEach(el => el.classList.remove('active'));
            document.querySelector(`.memory-type-card:nth-child(${type === 'flat' ? 1 : type === 'graph' ? 2 : 3})`).classList.add('active');
        }

        // Initialize
        initSampleData();
    </script>
</body>
</html>
